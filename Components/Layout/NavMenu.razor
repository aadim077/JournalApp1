@inject StreakService StreakService
@inject AuthService AuthService

<MudNavMenu>
    <MudNavLink Href="/" Match="NavLinkMatch.All" Icon="@Icons.Material.Filled.Dashboard">Dashboard</MudNavLink>
    <MudNavLink Href="/editor" Icon="@Icons.Material.Filled.Edit">Write Journal</MudNavLink>
    <MudNavLink Href="/timeline" Icon="@Icons.Material.Filled.Timeline">Timeline</MudNavLink>
    <MudNavLink Href="/calendar" Icon="@Icons.Material.Filled.CalendarMonth">Calendar</MudNavLink>
    <MudNavLink Href="/search" Icon="@Icons.Material.Filled.Search">Search & Filter</MudNavLink>
    
    @if (AuthService.CurrentUser != null)
    {
        <MudDivider Class="my-2" />
        <div class="px-4 py-2">
            <MudText Typo="Typo.subtitle2" Color="Color.Primary">Streaks</MudText>
            <MudText Typo="Typo.body2">🔥 Current: @_currentStreak days</MudText>
            <MudText Typo="Typo.body2">🏆 Longest: @_longestStreak days</MudText>
        </div>
    }
</MudNavMenu>

@code {
    private int _currentStreak = 0;
    private int _longestStreak = 0;

    protected override async Task OnParametersSetAsync()
    {
        if (AuthService.CurrentUser != null)
        {
            var streak = await StreakService.GetStreakAsync(AuthService.CurrentUser.Id);
            if (streak != null)
            {
                _currentStreak = streak.CurrentStreak;
                _longestStreak = streak.LongestStreak;
            }
        }
    }
}
